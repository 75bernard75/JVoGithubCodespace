# âœ… T3.3 Deployment Verification Guide

**Purpose**: Verify everything works after setup  
**Time**: 15 minutes  
**Required**: Completed server setup + GitHub Secrets added

---

## ğŸš€ Phase 1: Manual Deployment Test

### Step 1: Trigger Deploy Workflow

**In GitHub**:

1. Go to: https://github.com/75bernard75/JVoGithubCodespace
2. Click: **Actions** (top navigation)
3. Left sidebar: Click: **Deploy to Production**
4. Click: **Run workflow** (blue button, top right)
5. Select: Branch = **main**
6. Click: **Run workflow** (blue button)

**You'll see**: "triggered X seconds ago"

---

### Step 2: Monitor Workflow

**Watch the workflow run** (takes ~5 minutes):

#### Expected Steps (in order)

```
âœ… Checkout code
   â”œâ”€ Run: actions/checkout@v4
   â””â”€ Status: Completed (20 sec)

âœ… Setup Node.js
   â”œâ”€ Run: actions/setup-node@v4
   â””â”€ Status: Completed (30 sec)

âœ… Install Dependencies
   â”œâ”€ Run: npm ci
   â””â”€ Status: Completed (15 sec)

âœ… Build Eleventy
   â”œâ”€ Run: npm run build
   â””â”€ Status: Completed (2 min)

âœ… Upload Artifact
   â”œâ”€ Run: actions/upload-artifact@v4
   â””â”€ Status: Completed (10 sec)

âœ… Download Artifact
   â”œâ”€ Run: actions/download-artifact@v4
   â””â”€ Status: Completed (10 sec)

âœ… Setup SSH Key
   â”œâ”€ Run: mkdir ~/.ssh && chmod 700 ~/.ssh
   â””â”€ Status: Completed (5 sec)

âœ… Deploy via SSH
   â”œâ”€ Run: rsync -avz _site/ deploy@HOST:PATH/
   â””â”€ Status: Completed (30 sec)

âœ… Restart Web Server
   â”œâ”€ Run: ssh deploy@HOST 'sudo systemctl restart nginx'
   â””â”€ Status: Completed (10 sec)

âœ… Health Check
   â”œâ”€ Run: curl https://DEPLOY_HOST
   â””â”€ Status: Completed (5 sec)
```

**All steps**: Should be GREEN âœ…

---

### Step 3: Check Logs (if issues)

**If any step fails**:

1. Click the failed step name
2. Expand the command that failed
3. Read error message
4. Compare to troubleshooting section below

---

## ğŸ–¥ï¸ Phase 2: Verify Server

### Check 1: Files Uploaded

**SSH to your server**:

```bash
# Connect
ssh deploy@DEPLOY_HOST

# List files
ls -la /var/www/jvogaming/

# Should see: index.html, _redirects, etc.
```

**Expected output**:
```
total 234
drwxr-xr-x  5 deploy deploy  4096 Feb  1 10:30 .
drwxr-xr-x  3 root   root    4096 Jan 29 14:00 ..
-rw-r--r--  1 deploy deploy  3241 Feb  1 10:30 index.html
-rw-r--r--  1 deploy deploy  4562 Feb  1 10:30 about/
drwxr-xr-x  2 deploy deploy  4096 Feb  1 10:30 assets/
drwxr-xr-x  2 deploy deploy  4096 Feb  1 10:30 css/
-rw-r--r--  1 deploy deploy  2401 Feb  1 10:30 feed.xml
```

**Verify**: Files are there and recent! âœ…

---

### Check 2: Nginx Running

**On server**:

```bash
# Check nginx status
sudo systemctl status nginx

# Should show: active (running)
```

**Expected**:
```
â— nginx.service - A high performance web server and a reverse proxy server
     Loaded: loaded (/lib/systemd/system/nginx.service; enabled; preset: enabled)
     Active: active (running) since Tue 2026-02-01 10:30:45 UTC; 2min 30s ago
```

**Verify**: Service is running! âœ…

---

### Check 3: Domain Working

**Open in browser**:

```
https://jvogaming.com
```

(or your domain/IP)

**Expected**:
- Page loads
- No error
- HTTPS icon shows (ğŸ”’)
- Content displays

**Verify**: Site is live! âœ…

---

## ğŸ” Phase 3: Verify Content

### Check 1: HTML Files Present

**In browser dev tools** (F12):

1. Press: F12
2. Open: Network tab
3. Reload page
4. Check: All files load (green âœ…)

**Should see**:
- index.html (status 200)
- style.css (status 200)
- script.js (status 200)
- etc.

---

### Check 2: Check Recent Build

**In GitHub**:

1. Go to: Actions â†’ Deploy to Production
2. Click the workflow run
3. Check: "Completed successfully"
4. Check timestamp (should be recent)

**Verify**: Latest build deployed! âœ…

---

## ğŸ§ª Phase 4: Full Automated Test

### Trigger Export â†’ Build â†’ Deploy Chain

**Steps**:

1. Go to GitHub Actions
2. Click: "Nightly Directus Export"
3. Click: **Run workflow** â†’ **Run workflow**
4. Wait 3 minutes for export
5. Should auto-trigger build
6. Should auto-trigger deploy

**Watch the chain**:

```
Export completes
    â†“
Build starts (auto-triggered)
    â†“
Build completes
    â†“
Deploy starts (auto-triggered)
    â†“
Deploy completes
    â†“
Health check runs
    â†“
âœ… Site updated!
```

---

## ğŸ“Š Success Criteria

T3.3 is complete when ALL these pass âœ…:

### Workflow Tests
- [ ] Deploy workflow runs without errors
- [ ] All 8 steps complete (green âœ…)
- [ ] No red âŒ or yellow âš ï¸ steps
- [ ] Logs show no error messages

### Server Tests
- [ ] SSH access works
- [ ] Files in `/var/www/jvogaming/` are recent
- [ ] nginx is running
- [ ] Can restart nginx without error

### Browser Tests
- [ ] Domain loads (https://)
- [ ] HTTPS works (ğŸ”’ icon)
- [ ] No browser errors
- [ ] Content visible

### Full Chain Test
- [ ] Export workflow runs
- [ ] Build auto-triggers
- [ ] Deploy auto-triggers
- [ ] Site updates automatically
- [ ] Health check passes

---

## ğŸ†˜ Troubleshooting

### "Build failed"

**Check**:
1. Go to GitHub Actions
2. Click "Build" workflow
3. Expand failed step
4. Read error message

**Common causes**:
- Missing node_modules
- **Fix**: `npm ci` should install them

---

### "Deploy failed - Permission denied"

**Cause**: SSH key issue

**Fix**:
1. SSH to server manually:
   ```bash
   ssh deploy@jvogaming.com
   ```
2. If this fails, key is wrong
3. Regenerate key on server:
   ```bash
   ssh-keygen -t ed25519 -f ~/.ssh/github-deploy
   cat ~/.ssh/github-deploy
   ```
4. Copy entire key
5. Update DEPLOY_KEY secret in GitHub
6. Run workflow again

---

### "Connection timed out"

**Cause**: Server unreachable

**Fix**:
1. Verify server IP is correct in DEPLOY_HOST
2. Test SSH locally: `ssh deploy@DEPLOY_HOST`
3. If fails, check:
   - Server is running (reboot if needed)
   - Firewall allows port 22
   - Network connection

---

### "Files didn't upload"

**Cause**: rsync failed

**Check**:
1. Look at workflow logs
2. Find "Deploy via SSH" step
3. Read error message

**Common fixes**:
- Verify rsync installed on server:
  ```bash
  sudo apt install rsync
  ```
- Verify path exists:
  ```bash
  mkdir -p /var/www/jvogaming
  ```

---

### "Site shows old content"

**Cause**: Files uploaded but nginx not restarted

**Fix**:
1. SSH to server
2. Restart nginx:
   ```bash
   sudo systemctl restart nginx
   ```
3. Clear browser cache: Ctrl+Shift+Delete
4. Reload page

---

### "HTTPS doesn't work"

**Cause**: Certificate issue

**Fix**:
1. Check certificate exists:
   ```bash
   ls -la /etc/letsencrypt/live/jvogaming.com/
   ```
2. If missing, create:
   ```bash
   certbot certonly --nginx -d jvogaming.com
   ```
3. Restart nginx:
   ```bash
   sudo systemctl restart nginx
   ```

---

## ğŸ“‹ T3.3 Final Checklist

### Setup Complete
- [ ] Server running
- [ ] SSH access working
- [ ] nginx configured
- [ ] HTTPS certificate
- [ ] Deploy user created
- [ ] GitHub Secrets added (all 4)

### Workflow Tests
- [ ] Deploy workflow runs successfully
- [ ] All 8 steps complete (green âœ…)
- [ ] No errors in logs
- [ ] Execution time < 10 minutes

### Server Verification
- [ ] Can SSH to server
- [ ] Files updated recently
- [ ] nginx is running
- [ ] Can restart nginx

### Browser Verification
- [ ] Domain accessible (HTTPS)
- [ ] ğŸ”’ icon shows
- [ ] Content loads
- [ ] No JavaScript errors

### Full Chain
- [ ] Export workflow works (T3.2 âœ…)
- [ ] Build auto-triggers
- [ ] Deploy auto-triggers
- [ ] Site updates automatically

### Performance
- [ ] Load time < 3 seconds
- [ ] No 404 errors
- [ ] Images/CSS load
- [ ] Health check passes

---

## ğŸ¯ What's Next

### âœ… T3.3 Complete
All deployment infrastructure working automatically!

### â­ï¸ T3.4: Monitoring
- Health checks every 15 min
- Alerts on failure
- Performance tracking

### â­ï¸ LOT 4: Content
- Add gaming data
- Create guides
- Upload images
- Build affiliate system

---

## ğŸ“ Support

If stuck:

1. Check troubleshooting section above
2. Read workflow logs carefully
3. SSH to server and check manually
4. Compare with DEPLOYMENT_GUIDE.md

---

**Status**: T3.3 deployment verification guide ready ğŸš€

**Next**: Follow this guide step-by-step to verify

